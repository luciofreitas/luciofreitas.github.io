import{u as b,r as l,j as n}from"./index-CtwKFqaY.js";function N({requireAuth:v=!1,user:t=null,initialValues:g={},onRequireLogin:d=null,onSubmit:p=null}){const x=b(),[r,c]=l.useState({nome:"",email:"",mensagem:"",...g}),[i,h]=l.useState(!1),o=l.useRef(null),m=()=>`contato_rascunho_${t&&t.id?t.id:"anon"}`;l.useEffect(()=>{try{const e=localStorage.getItem(m());if(e){const a=JSON.parse(e);a&&typeof a=="object"&&c(f=>({...f,...a}))}}catch(e){console.warn("Failed to restore contato draft",e)}return()=>{o.current&&(clearTimeout(o.current),o.current=null)}},[t]),l.useEffect(()=>{t&&c(e=>({...e,nome:e.nome||t.nome||t.name||"",email:e.email||t.email||""}))},[t]);const u=e=>{const{name:a,value:f}=e.target,s={...r,[a]:f};c(s),o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{try{s.nome||s.email||s.mensagem?localStorage.setItem(m(),JSON.stringify(s)):localStorage.removeItem(m())}catch(S){console.warn("Failed to save contato draft",S)}o.current=null},700)};if(v&&!t){const e=()=>{if(typeof d=="function")return d();x("/login")};return n.jsxs("div",{className:"contato-need-login",children:[n.jsx("p",{children:"FaÃ§a login para enviar uma mensagem."}),n.jsx("button",{type:"button",className:"contato-login-btn",onClick:e,children:"Entrar"})]})}const y=async e=>{if(e.preventDefault(),!i){h(!0);try{typeof p=="function"?await p(r):alert("Mensagem enviada com sucesso!"),c({nome:"",email:"",mensagem:"",...g});try{localStorage.removeItem(m())}catch{}}catch(a){console.error("Erro ao enviar contato:",a),alert("Falha ao enviar a mensagem. Tente novamente.")}finally{h(!1)}}};return n.jsxs("form",{className:"contato-form-wrapper",onSubmit:y,children:[n.jsx("input",{name:"nome",className:"contato-input",type:"text",placeholder:"Seu nome",value:r.nome,onChange:u,required:!0}),n.jsx("input",{name:"email",className:"contato-input",type:"email",placeholder:"Seu e-mail",value:r.email,onChange:u,required:!0}),n.jsx("textarea",{name:"mensagem",className:"contato-textarea",placeholder:"Mensagem",rows:6,value:r.mensagem,onChange:u,required:!0}),n.jsx("button",{className:"contato-submit",type:"submit",disabled:i,children:i?"Enviando...":"Enviar Mensagem"})]})}export{N as C};
