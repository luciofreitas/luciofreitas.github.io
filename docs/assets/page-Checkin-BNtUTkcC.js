import{r as t,u as q,A as T,j as e}from"./index-5iGBe1ZQ.js";import{M as E}from"./index.esm-BMZToGVV.js";function G(){const[p,P]=t.useState(""),[r,M]=t.useState(""),[o,w]=t.useState(""),[g,A]=t.useState(""),[D,I]=t.useState(""),[x,N]=t.useState(!1),[V,O]=t.useState(!1),[j,v]=t.useState(""),[l,f]=t.useState(""),[d,k]=t.useState(""),[u,h]=t.useState(""),[m,C]=t.useState(""),S=q(),{usuarioLogado:n,setUsuarioLogado:b}=t.useContext(T)||{};t.useEffect(()=>{n||S("/login",{state:{redirectTo:"/checkin"}})},[n,S]);function $(s){s.preventDefault(),v("");let a=!1;if(p.trim()||(f("Nome é obrigatório."),a=!0),r.replace(/\D/g,"").length<12&&(k("Número de cartão inválido."),a=!0),!/^\d{2}\/\d{2}$/.test(o))h("Validade inválida. Use MM/AA."),a=!0;else{const[c,y]=o.split("/").map(U=>parseInt(U,10));c>=1&&c<=12||(h("Mês inválido."),a=!0)}if(/^\d{3,4}$/.test(g)||(C("CVC inválido."),a=!0),a){v("Revise os campos destacados.");return}N(!0),setTimeout(()=>{N(!1),O(!0);try{const c=JSON.parse(localStorage.getItem("payments")||"[]"),y={id:Date.now(),user:n?n.email||n.nome:"guest",amount:9.9,currency:"BRL",date:new Date().toISOString(),card:"**** **** **** "+r.replace(/\s+/g,"").slice(-4)};c.push(y),localStorage.setItem("payments",JSON.stringify(c))}catch{}if(n&&b){const c={...n,isPro:!0};b(c),localStorage.setItem("usuario-logado",JSON.stringify(c))}else try{localStorage.setItem("versaoProAtiva","true")}catch{}},1200)}function R(s){P(s),l&&s.trim()&&f("")}function F(s){const a=s.replace(/\D/g,"").slice(0,19),c=(a.match(/\d{1,4}/g)||[]).join(" ");M(c),d&&a.length>=12&&k("")}function J(s){const a=s.replace(/\D/g,"").slice(0,4);let i=a;a.length>=3&&(i=a.slice(0,2)+"/"+a.slice(2)),w(i),u&&/^\d{2}\/\d{2}$/.test(i)&&h("")}function L(s){const a=s.replace(/\D/g,"").slice(0,4);A(a),m&&/^\d{3,4}$/.test(a)&&C("")}return V?e.jsxs(e.Fragment,{children:[e.jsx(E,{}),e.jsx("div",{className:"site-header-spacer"}),e.jsx("div",{className:"page-wrapper menu-page",children:e.jsxs("div",{className:"page-content",children:[e.jsx("h2",{className:"page-title",children:"Pagamento concluído"}),e.jsx("p",{className:"checkin-success-text",children:"Obrigado — sua assinatura Pro foi ativada (simulado)."}),e.jsxs("p",{className:"checkin-success-text",children:["Você pode retornar à ",e.jsx("a",{href:"/",children:"página inicial"}),"."]})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx(E,{}),e.jsx("div",{className:"site-header-spacer"}),e.jsx("div",{className:"page-wrapper menu-page",children:e.jsx("div",{className:"page-content checkin-section",children:e.jsxs("div",{className:"checkin-container",children:[e.jsx("h2",{className:"page-title",children:"Finalizar Assinatura — Versão Pro"}),e.jsx("p",{className:"checkin-intro",children:"R$ 9,90/mês — cancelamento a qualquer momento."}),e.jsxs("form",{onSubmit:$,className:"checkin-form",children:[e.jsxs("label",{className:"checkin-label",children:["Nome no cartão",e.jsx("input",{className:"checkin-input checkin-input",value:p,onChange:s=>R(s.target.value),placeholder:"Nome completo"}),l&&e.jsx("div",{className:"checkin-error",children:l})]}),e.jsxs("label",{className:"checkin-label",children:["Número do cartão",e.jsx("input",{className:"checkin-input checkin-input",value:r,onChange:s=>F(s.target.value),placeholder:"1234 5678 9012 3456",inputMode:"numeric"}),d&&e.jsx("div",{className:"checkin-error",children:d})]}),e.jsxs("div",{className:"checkin-row",children:[e.jsxs("label",{className:"checkin-label checkin-row-item",children:["Validade",e.jsx("input",{className:"checkin-input checkin-input",value:o,onChange:s=>J(s.target.value),placeholder:"MM/AA",inputMode:"numeric"}),u&&e.jsx("div",{className:"checkin-error",children:u})]}),e.jsxs("label",{className:"checkin-label checkin-row-item-small",children:["CVC",e.jsx("input",{className:"checkin-input checkin-input",value:g,onChange:s=>L(s.target.value),placeholder:"123",inputMode:"numeric"}),m&&e.jsx("div",{className:"checkin-error",children:m})]})]}),e.jsxs("label",{className:"checkin-label",children:["Cupom (opcional)",e.jsx("input",{className:"checkin-input checkin-input",value:D,onChange:s=>I(s.target.value),placeholder:"CUPOM"})]}),j&&e.jsx("div",{className:"checkin-error-global",children:j}),e.jsxs("div",{className:"checkin-actions",children:[e.jsx("button",{type:"submit",disabled:x,className:"checkin-btn-primary",children:x?"Processando...":"Pagar R$ 9,90"}),e.jsx("button",{type:"button",onClick:()=>{window.history.back()},className:"checkin-btn-secondary",children:"Voltar"})]}),e.jsx("div",{className:"checkin-note",children:"Este é um formulário de pagamento simulado. Integre seu provedor de pagamentos (Stripe, PayPal, PagSeguro etc.) conforme necessário."})]})]})})})]})}export{G as default};
