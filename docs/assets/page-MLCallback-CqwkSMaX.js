import{u as h,a as f,r as t,A as y,j as e}from"./index-BdT7-cx_.js";const k=()=>{const o=h(),i=f(),{usuarioLogado:l}=t.useContext(y)||{},[n,s]=t.useState("processing"),[m,a]=t.useState(null);return t.useEffect(()=>{(async()=>{try{const r=new URLSearchParams(i.search),d=r.get("access_token"),x=r.get("refresh_token"),u=r.get("expires_in"),c=r.get("ml_error")||r.get("error");if(c){console.error("ML OAuth error:",c),a(`Erro na autorização: ${c}`),s("error"),setTimeout(()=>o("/#/configuracoes"),3e3);return}if(!d){console.error("No access token received"),a("Nenhum token de acesso recebido"),s("error"),setTimeout(()=>o("/#/configuracoes"),3e3);return}const g=Date.now()+parseInt(u)*1e3,p={accessToken:d,refreshToken:x,expiresIn:parseInt(u),expiresAt:g,userId:l?.id,connectedAt:new Date().toISOString()};localStorage.setItem("ml_token_data",JSON.stringify(p)),console.log("ML tokens stored successfully"),s("success"),setTimeout(()=>o("/#/configuracoes?ml_success=true"),1500)}catch(r){console.error("Error processing ML callback:",r),a("Erro ao processar autorização"),s("error"),setTimeout(()=>o("/#/configuracoes"),3e3)}})()},[i,o,l]),e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",padding:"2rem",backgroundColor:"#f5f5f5"},children:[e.jsxs("div",{style:{backgroundColor:"white",borderRadius:"8px",padding:"3rem",boxShadow:"0 2px 10px rgba(0,0,0,0.1)",maxWidth:"500px",textAlign:"center"},children:[n==="processing"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{width:"60px",height:"60px",border:"4px solid #f3f3f3",borderTop:"4px solid #3498db",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 1.5rem"}}),e.jsx("h2",{style:{color:"#333",marginBottom:"1rem"},children:"Processando autorização..."}),e.jsx("p",{style:{color:"#666"},children:"Aguarde enquanto conectamos sua conta do Mercado Livre"})]}),n==="success"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{width:"60px",height:"60px",backgroundColor:"#27ae60",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1.5rem"},children:e.jsx("span",{style:{color:"white",fontSize:"2rem"},children:"✓"})}),e.jsx("h2",{style:{color:"#27ae60",marginBottom:"1rem"},children:"Conexão realizada com sucesso!"}),e.jsx("p",{style:{color:"#666"},children:"Sua conta do Mercado Livre foi conectada. Redirecionando..."})]}),n==="error"&&e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{width:"60px",height:"60px",backgroundColor:"#e74c3c",borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",margin:"0 auto 1.5rem"},children:e.jsx("span",{style:{color:"white",fontSize:"2rem"},children:"✕"})}),e.jsx("h2",{style:{color:"#e74c3c",marginBottom:"1rem"},children:"Erro na conexão"}),e.jsx("p",{style:{color:"#666"},children:m||"Ocorreu um erro ao conectar com o Mercado Livre"}),e.jsx("p",{style:{color:"#999",fontSize:"0.9rem",marginTop:"1rem"},children:"Redirecionando para configurações..."})]})]}),e.jsx("style",{children:`
        @keyframes spin {
          0% { transform: rotate(0deg); }
          100% { transform: rotate(360deg); }
        }
      `})]})};export{k as default};
