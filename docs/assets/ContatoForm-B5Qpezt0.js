import{u as S,r as l,j as n}from"./index-Z7eOC0HN.js";function E({requireAuth:v=!1,user:a=null,initialValues:f={},onRequireLogin:d=null,onSubmit:p=null}){const x=S(),[r,m]=l.useState({nome:"",email:"",mensagem:"",...f}),[i,h]=l.useState(!1),o=l.useRef(null),c=()=>`contato_rascunho_${a&&a.id?a.id:"anon"}`;l.useEffect(()=>{try{const e=localStorage.getItem(c());if(e){const t=JSON.parse(e);t&&typeof t=="object"&&m(g=>({...g,...t}))}}catch(e){console.warn("Failed to restore contato draft",e)}return()=>{o.current&&(clearTimeout(o.current),o.current=null)}},[a]),l.useEffect(()=>{a&&m(e=>({...e,nome:e.nome||a.nome||a.name||"",email:e.email||a.email||""}))},[a]);const u=e=>{const{name:t,value:g}=e.target,s={...r,[t]:g};m(s),o.current&&clearTimeout(o.current),o.current=setTimeout(()=>{try{s.nome||s.email||s.mensagem?localStorage.setItem(c(),JSON.stringify(s)):localStorage.removeItem(c())}catch(b){console.warn("Failed to save contato draft",b)}o.current=null},700)};if(v&&!a){const e=()=>{if(typeof d=="function")return d();x("/login")};return n.jsxs("div",{className:"contato-need-login",children:[n.jsx("p",{children:"Faça login para enviar uma mensagem."}),n.jsx("button",{type:"button",className:"contato-login-btn",onClick:e,children:"Entrar"})]})}const y=async e=>{if(e.preventDefault(),!i){h(!0);try{typeof p=="function"?await p(r):(console.log("Dados do contato:",r),console.log("Email será enviado para: suportegaragemsmart@gmail.com"),alert("Mensagem enviada com sucesso! Em breve entraremos em contato.")),m({nome:"",email:"",mensagem:"",...f});try{localStorage.removeItem(c())}catch{}}catch(t){console.error("Erro ao enviar contato:",t),alert("Falha ao enviar a mensagem. Tente novamente.")}finally{h(!1)}}};return n.jsxs("form",{className:"contato-form-wrapper",onSubmit:y,children:[n.jsx("input",{name:"nome",className:"contato-input",type:"text",placeholder:"Seu nome",value:r.nome,onChange:u,required:!0}),n.jsx("input",{name:"email",className:"contato-input",type:"email",placeholder:"Seu e-mail",value:r.email,onChange:u,required:!0}),n.jsx("textarea",{name:"mensagem",className:"contato-textarea",placeholder:"Mensagem",rows:6,value:r.mensagem,onChange:u,required:!0}),n.jsx("button",{className:"contato-submit",type:"submit",disabled:i,children:i?"Enviando...":"Enviar Mensagem"})]})}export{E as C};
