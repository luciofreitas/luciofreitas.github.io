import{r as i,j as e,M as E,L as j,s as p}from"./index-CrzsTBqL.js";import{E as N}from"./emailService-CRvz_6uC.js";function S(){const[r,u]=i.useState(""),[n,o]=i.useState(!1),[v,l]=i.useState(""),[h,c]=i.useState(""),[f,x]=i.useState(!1),g=async t=>{t.preventDefault(),o(!0),c(""),l("");try{const a=r.toLowerCase().trim(),{data:s}=await p.from("users").select("id, nome, email").eq("email",a).single(),{error:d}=await p.auth.resetPasswordForEmail(a,{redirectTo:`${window.location.origin}/#/redefinir-senha`});if(d&&!s){c("Email nÃ£o encontrado. Verifique e tente novamente."),o(!1);return}if(d&&console.warn("Aviso Supabase Auth:",d),s)try{const m=`${window.location.origin}/#/redefinir-senha`;await N.sendPasswordResetEmail({nome:s.nome||"UsuÃ¡rio",email:s.email,userId:s.id,resetLink:m})}catch(m){console.warn("Aviso: Email personalizado nÃ£o enviado, mas email padrÃ£o do Supabase foi enviado.",m)}x(!0),l(`âœ… Email de recuperaÃ§Ã£o enviado para ${a}. Verifique sua caixa de entrada e spam.`)}catch(a){console.error("Erro ao solicitar recuperaÃ§Ã£o de senha:",a),c("Erro ao enviar email de recuperaÃ§Ã£o. Tente novamente mais tarde.")}finally{o(!1)}};return e.jsxs("div",{className:"page-wrapper",children:[e.jsx(E,{}),e.jsx("div",{className:"esqueci-senha-container",children:e.jsxs("div",{className:"esqueci-senha-card",children:[e.jsxs("div",{className:"esqueci-senha-header",children:[e.jsx("h1",{children:"ğŸ” Esqueci minha senha"}),e.jsx("p",{children:"NÃ£o se preocupe! Vamos te ajudar a recuperar o acesso Ã  sua conta."})]}),f?e.jsxs("div",{className:"success-container",children:[e.jsx("div",{className:"success-message",children:v}),e.jsxs("div",{className:"success-info",children:[e.jsx("h3",{children:"ğŸ“¬ PrÃ³ximos passos:"}),e.jsxs("ul",{children:[e.jsxs("li",{children:["âœ… Verifique sua caixa de entrada em ",e.jsx("strong",{children:r})]}),e.jsx("li",{children:"âœ… Procure por email da Garagem Smart"}),e.jsxs("li",{children:["âœ… Se nÃ£o encontrar, verifique a pasta de ",e.jsx("strong",{children:"SPAM"})]}),e.jsx("li",{children:"âœ… Clique no link de recuperaÃ§Ã£o"}),e.jsx("li",{children:"âœ… Defina sua nova senha"})]})]}),e.jsx("button",{onClick:()=>{x(!1),u(""),l("")},className:"resend-btn",children:"ğŸ“§ Reenviar email"})]}):e.jsxs("form",{onSubmit:g,className:"esqueci-senha-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"email",children:"Email cadastrado:"}),e.jsx("input",{type:"email",id:"email",value:r,onChange:t=>u(t.target.value),placeholder:"seuemail@exemplo.com",required:!0,disabled:n,className:"input-field"})]}),h&&e.jsxs("div",{className:"error-message",children:["âŒ ",h]}),e.jsx("button",{type:"submit",className:"submit-btn",disabled:n,children:n?"â³ Enviando...":"ğŸ“§ Enviar Email de RecuperaÃ§Ã£o"}),e.jsxs("div",{className:"info-box",children:[e.jsxs("p",{children:["ğŸ“Œ ",e.jsx("strong",{children:"Como funciona:"})]}),e.jsxs("ol",{children:[e.jsx("li",{children:"Digite seu email cadastrado"}),e.jsx("li",{children:"VocÃª receberÃ¡ um link de recuperaÃ§Ã£o"}),e.jsx("li",{children:"Clique no link e defina uma nova senha"}),e.jsx("li",{children:"Pronto! FaÃ§a login com a nova senha"})]})]})]}),e.jsxs("div",{className:"login-links",children:[e.jsx(j,{to:"/login",className:"back-link",children:"â† Voltar para o login"}),e.jsx(j,{to:"/cadastro",className:"signup-link",children:"NÃ£o tem conta? Cadastre-se"})]})]})})]})}export{S as default};
