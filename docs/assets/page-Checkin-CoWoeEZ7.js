import{r as t,A as U,j as e}from"./index-C_ynvUNC.js";import{M as y}from"./index.esm-jhx5TM3I.js";function B(){const[p,E]=t.useState(""),[i,P]=t.useState(""),[o,M]=t.useState(""),[g,w]=t.useState(""),[A,D]=t.useState(""),[x,N]=t.useState(!1),[I,V]=t.useState(!1),[j,v]=t.useState(""),[l,f]=t.useState(""),[d,k]=t.useState(""),[u,h]=t.useState(""),[m,C]=t.useState(""),{usuarioLogado:n,setUsuarioLogado:S}=t.useContext(U)||{};function O(s){s.preventDefault(),v("");let a=!1;if(p.trim()||(f("Nome é obrigatório."),a=!0),i.replace(/\D/g,"").length<12&&(k("Número de cartão inválido."),a=!0),!/^\d{2}\/\d{2}$/.test(o))h("Validade inválida. Use MM/AA."),a=!0;else{const[c,b]=o.split("/").map(L=>parseInt(L,10));c>=1&&c<=12||(h("Mês inválido."),a=!0)}if(/^\d{3,4}$/.test(g)||(C("CVC inválido."),a=!0),a){v("Revise os campos destacados.");return}N(!0),setTimeout(()=>{N(!1),V(!0);try{const c=JSON.parse(localStorage.getItem("payments")||"[]"),b={id:Date.now(),user:n?n.email||n.nome:"guest",amount:9.9,currency:"BRL",date:new Date().toISOString(),card:"**** **** **** "+i.replace(/\s+/g,"").slice(-4)};c.push(b),localStorage.setItem("payments",JSON.stringify(c))}catch{}if(n&&S){const c={...n,isPro:!0};S(c),localStorage.setItem("usuario-logado",JSON.stringify(c))}else try{localStorage.setItem("versaoProAtiva","true")}catch{}},1200)}function $(s){E(s),l&&s.trim()&&f("")}function R(s){const a=s.replace(/\D/g,"").slice(0,19),c=(a.match(/\d{1,4}/g)||[]).join(" ");P(c),d&&a.length>=12&&k("")}function F(s){const a=s.replace(/\D/g,"").slice(0,4);let r=a;a.length>=3&&(r=a.slice(0,2)+"/"+a.slice(2)),M(r),u&&/^\d{2}\/\d{2}$/.test(r)&&h("")}function J(s){const a=s.replace(/\D/g,"").slice(0,4);w(a),m&&/^\d{3,4}$/.test(a)&&C("")}return I?e.jsxs(e.Fragment,{children:[e.jsx(y,{}),e.jsx("div",{className:"page-wrapper menu-page",children:e.jsxs("div",{className:"page-content",children:[e.jsx("h2",{className:"page-title",children:"Pagamento concluído"}),e.jsx("p",{className:"checkin-success-text",children:"Obrigado — sua assinatura Pro foi ativada (simulado)."}),e.jsxs("p",{className:"checkin-success-text",children:["Você pode retornar à ",e.jsx("a",{href:"/",children:"página inicial"}),"."]})]})})]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{}),e.jsx("div",{className:"page-wrapper menu-page",children:e.jsx("div",{className:"page-content checkin-section",children:e.jsxs("div",{className:"checkin-container",children:[e.jsx("h2",{className:"page-title",children:"Finalizar Assinatura — Versão Pro"}),e.jsx("p",{className:"checkin-intro",children:"R$ 9,90/mês — cancelamento a qualquer momento."}),e.jsxs("form",{onSubmit:O,className:"checkin-form",children:[e.jsxs("label",{className:"checkin-label",children:["Nome no cartão",e.jsx("input",{className:"checkin-input checkin-input",value:p,onChange:s=>$(s.target.value),placeholder:"Nome completo"}),l&&e.jsx("div",{className:"checkin-error",children:l})]}),e.jsxs("label",{className:"checkin-label",children:["Número do cartão",e.jsx("input",{className:"checkin-input checkin-input",value:i,onChange:s=>R(s.target.value),placeholder:"1234 5678 9012 3456",inputMode:"numeric"}),d&&e.jsx("div",{className:"checkin-error",children:d})]}),e.jsxs("div",{className:"checkin-row",children:[e.jsxs("label",{className:"checkin-label checkin-row-item",children:["Validade",e.jsx("input",{className:"checkin-input checkin-input",value:o,onChange:s=>F(s.target.value),placeholder:"MM/AA",inputMode:"numeric"}),u&&e.jsx("div",{className:"checkin-error",children:u})]}),e.jsxs("label",{className:"checkin-label checkin-row-item-small",children:["CVC",e.jsx("input",{className:"checkin-input checkin-input",value:g,onChange:s=>J(s.target.value),placeholder:"123",inputMode:"numeric"}),m&&e.jsx("div",{className:"checkin-error",children:m})]})]}),e.jsxs("label",{className:"checkin-label",children:["Cupom (opcional)",e.jsx("input",{className:"checkin-input checkin-input",value:A,onChange:s=>D(s.target.value),placeholder:"CUPOM"})]}),j&&e.jsx("div",{className:"checkin-error-global",children:j}),e.jsxs("div",{className:"checkin-actions",children:[e.jsx("button",{type:"submit",disabled:x,className:"checkin-btn-primary",children:x?"Processando...":"Pagar R$ 9,90"}),e.jsx("button",{type:"button",onClick:()=>{window.history.back()},className:"checkin-btn-secondary",children:"Voltar"})]}),e.jsx("div",{className:"checkin-note",children:"Este é um formulário de pagamento simulado. Integre seu provedor de pagamentos (Stripe, PayPal, PagSeguro etc.) conforme necessário."})]})]})})})]})}export{B as default};
