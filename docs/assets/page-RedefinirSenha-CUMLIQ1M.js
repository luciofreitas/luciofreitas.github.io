import{r as a,u as L,j as e,M as u,s as g}from"./index-DUGncIxD.js";function T(){const[c,S]=a.useState(""),[p,N]=a.useState(""),[l,v]=a.useState(!1),[m,s]=a.useState(""),[k,b]=a.useState(!1),[w,i]=a.useState(!1),[y,o]=a.useState(!0),[f,E]=a.useState(""),d=L();a.useEffect(()=>{(()=>{try{const r=new URLSearchParams(window.location.hash.split("?")[1]),t=r.get("token"),h=r.get("email");if(!t||!h){s("Link de recuperaÃ§Ã£o invÃ¡lido. Solicite um novo link."),i(!1),o(!1);return}const x=localStorage.getItem(`reset_token_${h}`);if(!x){s("Link de recuperaÃ§Ã£o invÃ¡lido ou expirado. Solicite um novo link."),i(!1),o(!1);return}const j=JSON.parse(x);if(j.token!==t||Date.now()>j.expiresAt){s("Link de recuperaÃ§Ã£o expirado. Solicite um novo link."),i(!1),o(!1),localStorage.removeItem(`reset_token_${h}`);return}E(h),i(!0),o(!1)}catch(r){console.error("Erro ao verificar token:",r),s("Erro ao validar link de recuperaÃ§Ã£o."),i(!1),o(!1)}})()},[]);const C=async n=>{if(n.preventDefault(),s(""),c.length<6){s("A senha deve ter pelo menos 6 caracteres.");return}if(c!==p){s("As senhas nÃ£o coincidem.");return}v(!0);try{const{error:r}=await g.auth.signInWithPassword({email:f,password:"temporary-password-for-reset"}),{error:t}=await g.auth.updateUser({email:f,password:c});if(t)throw t;localStorage.removeItem(`reset_token_${f}`),b(!0),setTimeout(()=>{d("/login")},3e3)}catch(r){console.error("Erro ao redefinir senha:",r),s("Erro ao redefinir senha. Tente novamente ou solicite um novo link.")}finally{v(!1)}};return y?e.jsxs("div",{className:"page-wrapper",children:[e.jsx(u,{}),e.jsx("div",{className:"redefinir-senha-container",children:e.jsx("div",{className:"redefinir-senha-card",children:e.jsx("div",{className:"loading-message",children:"â³ Verificando link de recuperaÃ§Ã£o..."})})})]}):w?k?e.jsxs("div",{className:"page-wrapper",children:[e.jsx(u,{}),e.jsx("div",{className:"redefinir-senha-container",children:e.jsx("div",{className:"redefinir-senha-card",children:e.jsxs("div",{className:"success-container",children:[e.jsx("h2",{children:"âœ… Senha Redefinida!"}),e.jsx("p",{children:"Sua senha foi alterada com sucesso!"}),e.jsx("p",{className:"redirect-message",children:"Redirecionando para o login em 3 segundos..."}),e.jsx("button",{onClick:()=>d("/login"),className:"action-btn",children:"Ir para o login agora"})]})})})]}):e.jsxs("div",{className:"page-wrapper",children:[e.jsx(u,{}),e.jsx("div",{className:"redefinir-senha-container",children:e.jsxs("div",{className:"redefinir-senha-card",children:[e.jsxs("div",{className:"redefinir-senha-header",children:[e.jsx("h1",{children:"ğŸ”‘ Redefinir Senha"}),e.jsx("p",{children:"Crie uma nova senha segura para sua conta."})]}),e.jsxs("form",{onSubmit:C,className:"redefinir-senha-form",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"novaSenha",children:"Nova Senha:"}),e.jsx("input",{type:"password",id:"novaSenha",value:c,onChange:n=>S(n.target.value),placeholder:"Digite sua nova senha",required:!0,disabled:l,className:"input-field",minLength:6}),e.jsx("small",{className:"hint",children:"MÃ­nimo 6 caracteres"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{htmlFor:"confirmarSenha",children:"Confirmar Nova Senha:"}),e.jsx("input",{type:"password",id:"confirmarSenha",value:p,onChange:n=>N(n.target.value),placeholder:"Digite a senha novamente",required:!0,disabled:l,className:"input-field",minLength:6})]}),m&&e.jsxs("div",{className:"error-message",children:["âŒ ",m]}),e.jsx("button",{type:"submit",className:"submit-btn",disabled:l,children:l?"â³ Salvando...":"âœ… Redefinir Senha"}),e.jsxs("div",{className:"security-tips",children:[e.jsx("h3",{children:"ğŸ›¡ï¸ Dicas de SeguranÃ§a:"}),e.jsxs("ul",{children:[e.jsx("li",{children:"âœ… Use pelo menos 6 caracteres"}),e.jsx("li",{children:"âœ… Misture letras, nÃºmeros e sÃ­mbolos"}),e.jsx("li",{children:"âœ… NÃ£o use senhas Ã³bvias (123456, senha, etc.)"}),e.jsx("li",{children:"âœ… NÃ£o compartilhe sua senha com ninguÃ©m"})]})]})]})]})})]}):e.jsxs("div",{className:"page-wrapper",children:[e.jsx(u,{}),e.jsx("div",{className:"redefinir-senha-container",children:e.jsx("div",{className:"redefinir-senha-card",children:e.jsxs("div",{className:"error-container",children:[e.jsx("h2",{children:"âŒ Link InvÃ¡lido"}),e.jsx("p",{children:m}),e.jsx("button",{onClick:()=>d("/esqueci-senha"),className:"action-btn",children:"ğŸ” Solicitar novo link"}),e.jsx("button",{onClick:()=>d("/login"),className:"secondary-btn",children:"â† Voltar ao login"})]})})})]})}export{T as default};
