<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>OAuth Callback</title>
</head>
<body>
<script>
(function(){
  try {
    const href = window.location.href || '';
    const find = (name) => {
      const re = new RegExp(name + "=([^&#\\/]+)", 'i');
      const m = href.match(re);
      return m ? decodeURIComponent(m[1]) : null;
    };

    const access_token = find('access_token');
    const refresh_token = find('refresh_token');
    const error = find('error');

    if (error) {
      try { localStorage.setItem('oauth_error', error); } catch (e) {}
    } else if (access_token) {
      // Persist minimal token set for the SPA to pick up
      try {
        localStorage.setItem('supabase_oauth_tokens', JSON.stringify({ access_token: access_token, refresh_token: refresh_token || null }));
      } catch (e) {}
    }
  } catch (e) {
    // ignore
  }
  try { window.location.replace(window.location.origin + '/#/'); } catch(e) { window.location.href = '/#/'; }
})();
</script>
</body>
</html>